{% extends 'assistant/base.html' %}

{% block content %}
<div class="form-container">
    <h2>Personal Fitness Assessment</h2>
    
    {% if error %}
    <div class="error-message">
        {{ error }}
    </div>
    {% endif %}
    
    <form method="post" class="fitness-form" onsubmit="return showLoader()">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="gender">Gender</label>
            <select id="gender" name="gender" required>
                <option value="">Select Gender</option>
                <option value="M">Male</option>
                <option value="F">Female</option>
                <option value="O">Other</option>
            </select>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="age">Age</label>
                <input type="number" id="age" name="age" min="15" max="100" required>
            </div>
            
            <div class="form-group">
                <label for="weight">Weight (kg)</label>
                <input type="number" id="weight" name="weight" step="0.1" min="30" max="300" required>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="height">Height (cm)</label>
                <input type="number" id="height" name="height" step="0.1" min="100" max="250" required>
            </div>
            
            <div class="form-group">
                <label for="waist_circumference">Waist Circumference (cm)</label>
                <input type="number" id="waist_circumference" name="waist_circumference" step="0.1" min="50" max="200" required>
            </div>
        </div>
        
        <div class="form-group">
            <label for="health_goal">Health Goal</label>
            <textarea id="health_goal" name="health_goal" placeholder="Describe your fitness goals (e.g., lose weight, build muscle, improve endurance, etc.)" required rows="3"></textarea>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="duration">Duration (weeks - optional)</label>
                <input type="number" id="duration" name="duration" min="1" max="52" placeholder="e.g., 12">
            </div>
            
            <div class="form-group">
                <label for="food_preference">Food Preference (optional)</label>
                <select id="food_preference" name="food_preference">
                    {% for value, label in assessment.FOOD_PREFERENCES %}
                    <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="workout_place">Workout Place Preference (optional)</label>
            <select id="workout_place" name="workout_place">
                {% for value, label in assessment.WORKOUT_PLACES %}
                <option value="{{ value }}">{{ label }}</option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit" class="submit-btn" id="submitBtn">
            Generate Fitness Plan
        </button>
    </form>
</div>

<script>
    // Additional safety to prevent multiple submissions
    document.querySelector('.fitness-form').addEventListener('submit', function(e) {
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.innerHTML = 'Generating...';
    });

    // Re-enable button if user goes back
    window.addEventListener('pageshow', function(event) {
        const submitBtn = document.getElementById('submitBtn');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.innerHTML = 'Generate Fitness Plan';
        }
    });
</script>
{% endblock %}